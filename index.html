<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="我吃西瓜">
<meta property="og:url" content="http://eraise.xyz/index.html">
<meta property="og:site_name" content="我吃西瓜">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="我吃西瓜">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 6343457424082470000,
      author: '落羽"'
    }
  };
</script>




  <link rel="canonical" href="http://eraise.xyz/"/>

  <title> 我吃西瓜 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">我吃西瓜</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">一念红尘，一念空门</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/09/recyclerview-e7-9a-84-e4-bd-bf-e7-94-a8/" itemprop="url">
                  RecyclerView 的使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-09T15:38:35+08:00" content="2016-08-09">
              2016-08-09
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Android笔记/" itemprop="url" rel="index">
                    <span itemprop="name">Android笔记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="·-简介"><a href="#·-简介" class="headerlink" title="· 简介"></a>· 简介</h3><p>RecyclerView 已经不是一个新的东西了，我相信大部分的 Android 开发者都已经开始使用了。碰上过许多朋友问我：RecyclerView 跟 ListView 相比，有什么好处？我总是只能回答：更灵活，更新！灵活在哪里我说不出来，新也不是使用它的理由 – 况且使用它还更麻烦了。使用 RecyclerView 和 ListView 差不多，只是需要一个而已管理器， LinearLayoutManager GridLayoutManager 什么的。<br>但是这样就算是会用了吗？除了更麻烦以外(没有 onItemClickListener onItemLongClickListener，设置 Header Footer也麻烦些)，它有什么好处？</p>
<p>还有什么好处，我也不知道，以上都是废话。。。。</p>
<h3 id="·-既然如此，那我写这个要干嘛？"><a href="#·-既然如此，那我写这个要干嘛？" class="headerlink" title="· 既然如此，那我写这个要干嘛？"></a>· 既然如此，那我写这个要干嘛？</h3><p>想要普及 RecyclerView 几个简单的，却能提升用户体验的东西，看一下我的效果：<br><img src="/image/2016-08-recyclerview.gif" alt=""></p>
<p>比 ListView 更容易的实现动画、拖拽等。</p>
<h3 id="·-介绍工具吧！"><a href="#·-介绍工具吧！" class="headerlink" title="· 介绍工具吧！"></a>· 介绍工具吧！</h3><p>所谓工具，就是相关的几个类，有兴趣的可以去看看详细的信息，没兴趣的可以直接看代码了：</p>
<ul>
<li><a href="https://developer.android.com/reference/android/support/v7/widget/helper/ItemTouchHelper.html" target="_blank" rel="external">RecyclerView.ItemTouchHelper</a> 滑动删除、拖拽这次 Android 终于帮我们实现了</li>
<li><a href="https://developer.android.com/reference/android/support/v7/widget/RecyclerView.ItemDecoration.html" target="_blank" rel="external">RecyclerView.ItemDecoration</a> ItemTouchHelper 的老爹来了，用它能实现不少事情，网上也有用它来实现方便的 onItemClickListener 什么的，善加利用一定是个好东西</li>
</ul>
<h3 id="·-coding…"><a href="#·-coding…" class="headerlink" title="· coding…"></a>· coding…</h3><ul>
<li>写xml，写 Activity 的就省略了</li>
<li><p>ViewHolder，代码没逻辑不细述</p>
<p>public class MyViewHolder extends RecyclerView.ViewHolder {</p>
<pre><code>public TextView tvName;
public TextView tvPhone;
public TextView tvAddress;

public MyViewHolder(View itemView) {
    super(itemView);

    findViews();
}

private void findViews() {
    tvName = (TextView) itemView.findViewById(R.id.tv_name);
    tvPhone = (TextView) itemView.findViewById(R.id.tv_phone);
    tvAddress = (TextView) itemView.findViewById(R.id.tv_address);
}
</code></pre><p>}<br>`</p>
</li>
<li><p>再写一个 Adapter，代码没逻辑，不细述</p>
<pre>`public class MyAdapter extends RecyclerView.Adapter&lt;MyViewHolder&gt; {

    private Context context;
    private ArrayList&lt;AddressInfo&gt; data;

    public MyAdapter(Context context) {
        this.context = context;
        data = new ArrayList&lt;&gt;();
    }

    public void add(AddressInfo info) {
        data.add(info);
    }

    public void add(int position, AddressInfo info) {
        data.add(position, info);
    }

    public void remove(AddressInfo info) {
        data.remove(info);
    }

    public void remove(int position) {
        data.remove(position);
    }

    public AddressInfo getAddressInfo(int position) {
        return data.get(position);
    }

    @Override
    public MyViewHolder onCreateViewHolder(ViewGroup parent, int viewType) {
        return new MyViewHolder(LayoutInflater.from(context).inflate(R.layout.item_address, parent, false));
    }

    @Override
    public void onBindViewHolder(MyViewHolder holder, int position) {
        AddressInfo info = data.get(position);

        holder.tvName.setText(info.name);
        holder.tvPhone.setText(info.phone);
        holder.tvAddress.setText(holder.tvAddress.getResources().getString(R.string.address_, info.address));
    }

    @Override
    public int getItemCount() {
        return data.size();
    }
}
`</pre>
</li>
<li><p>希望 Item 之间能有个分割线，可以加个 Decorator</p>
<pre>`/**
 * ItemDecoration 是用来装饰 Item 的，用它可以做许多事情， ItemTouchHelper 就是它的子类，&lt;br/&gt;
 * 通过 ItemDecoration 可以去绘制分割线、自定义一个 OnClickListener 等
 * &lt;br/&gt;
 * &lt;br/&gt;
 * {@link #onDraw(Canvas, RecyclerView, RecyclerView.State)} 和 {@link #onDrawOver(Canvas, RecyclerView, RecyclerView.State)} 的区别是画在上面还是画在下面，over画的东西将会覆盖在 Item 之上
 */
public class MyDecorator extends RecyclerView.ItemDecoration {

    @Override
    public void getItemOffsets(Rect outRect, View view, RecyclerView parent, RecyclerView.State state) {
        if (parent.getChildAdapterPosition(view) == 0)  // getChildAdapterPosition 可以得到 childView 在 Adapter 中的 position
            outRect.top = 0;
        else {
            outRect.top = dp2px(10, view.getContext());
        }
    }

    private int dp2px(int dp, Context context) {
        return (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, dp, context.getResources().getDisplayMetrics());
    }
}
`</pre>
</li>
<li><p>MainActivity，这里的我拆开</p>
</li>
<li><p>对 RecyclerView 进行一些初始化</p>
<pre>`// 最基础使用的设置
mAdapter = new MyAdapter(this);
        // 设置布局方式为线性垂直
        mRecyclerView.setLayoutManager(new LinearLayoutManager(this));
        mRecyclerView.setAdapter(mAdapter);
        mRecyclerView.addItemDecoration(new MyDecorator());
`</pre>

<pre>`// 滑动滚动需要 ItemTouchHelper，而 ItemTouchHelper 需要一个回调来得知自己应该如何去处理用户的触摸事件
ItemTouchHelper touchHelper = new ItemTouchHelper(new ItemTouchHelper.Callback() {
            @Override
            public int getMovementFlags(RecyclerView recyclerView, RecyclerView.ViewHolder viewHolder) {
                // 设置为允许向左滑动，允许向上向下托拽
                return makeFlag(ItemTouchHelper.ACTION_STATE_DRAG,
                            ItemTouchHelper.UP | ItemTouchHelper.DOWN)
                        | makeFlag(ItemTouchHelper.ACTION_STATE_SWIPE, ItemTouchHelper.LEFT);
            }

            @Override
            public boolean onMove(RecyclerView recyclerView, RecyclerView.ViewHolder viewHolder, RecyclerView.ViewHolder target) {
                // 改变数据位置
                int position = viewHolder.getAdapterPosition();
                int targetPosition = target.getAdapterPosition();
                if (position == targetPosition) {
                    return false;
                }
                Log.d("drag", position + ", " + targetPosition);
                AddressInfo info = mAdapter.getAddressInfo(position);
                mAdapter.remove(position);
                mAdapter.add(targetPosition, info);
                mAdapter.notifyItemMoved(position, targetPosition);

                return true;
            }

            @Override
            public void onSwiped(RecyclerView.ViewHolder viewHolder, int direction) {
                // getAdapterPosition可以得到 ViewHolder 在 Adapter 中的位置
                int position = viewHolder.getAdapterPosition();
                mAdapter.remove(position);
                mAdapter.notifyItemRemoved(position);
            }
        });
`</pre>

<p><pre>`// 最后将 ItemTouchHelper 跟 RecyclerView 做一下关联<br>touchHelper.attachToRecyclerView(mRecyclerView);</pre></p>
</li>
<li><p>通过以上的代码，RecyclerView 运行滑动删除、上下拖拽，不过为了让效果更好，需要用 RecyclerView 新引入的<span style="color:red">局部刷新</span>，局部刷新通过调用<code>mAdapter.notifyItemInserted(0)</code> <code>mAdapter.notifyItemMoved(position, targetPosition)</code> <code>mAdapter.notifyItemRemoved(position)</code> 来完成。</p>
</li>
</ul>
<h3 id="·-这是个简单的教程，没什么内容，所以结束了。。。"><a href="#·-这是个简单的教程，没什么内容，所以结束了。。。" class="headerlink" title="· 这是个简单的教程，没什么内容，所以结束了。。。"></a>· 这是个简单的教程，没什么内容，所以结束了。。。</h3><blockquote>
<p>我有一个界面，在 RecyclerView 的最底下有一个按钮，点击就会添加一行，如果满5个，这个按钮就没消失，item减少的时候，这个按钮又会出来。这个时候，在执行 <code>mAdapter.notifyItemRemoved()</code>后，我去点击按钮，结果崩溃了，解救的方法是，在 removed 之后， insert 一个。</p>
</blockquote>
<p><a href="http://ofc66dujp.bkt.clouddn.com/RecyclerDemo.zip" target="_blank" rel="external">源码下载</a></p>
<p>相关资料：</p>
<ul>
<li><a href="http://stackoverflow.com/a/27037230/4737579" target="_blank" rel="external">在 RecyclerView 的 Item 之间添加间距</a></li>
<li><a href="http://stackoverflow.com/a/30644208/4737579" target="_blank" rel="external">RecyclerView 通过 ItemTouchHelper 实现拖拽</a></li>
<li><a href="http://stackoverflow.com/a/30601554/4737579" target="_blank" rel="external">RecyclerView 通过 ItemTouchHelper 实现滑动删除</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/01/e6-88-91-e7-9a-84-e6-8c-87-e9-92-88-e5-9c-a8-e4-b9-b1-e6-8c-87-ef-bc-9fc-e5-86-85-e5-ad-98-e7-9a-84-e4-b8-80-e4-b8-aa-e5-9d-91-md/" itemprop="url">
                  我的指针在乱指？C++内存的一个坑
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-01T17:43:29+08:00" content="2016-08-01">
              2016-08-01
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/C-笔记/" itemprop="url" rel="index">
                    <span itemprop="name">C++笔记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="·-故事的开头"><a href="#·-故事的开头" class="headerlink" title="· 故事的开头"></a>· 故事的开头</h3><p>最近又想学C++了，又看了一遍，这次回顾到了模板这里，例子是用 vector 去实现 Stack，我就想自己用链式来实现一个好了。链式的思路其实是很简单的，我觉得它应该是最简单的：每个结点记住自己的前一个结点是什么，Stack记住最后一个进来的结点，然后就能 push 啊 pop 啊的，想想挺简单的，10分钟搞定。</p>
<h3 id="·-前方熊出没"><a href="#·-前方熊出没" class="headerlink" title="· 前方熊出没"></a>· 前方熊出没</h3><p>很开心的花了几分钟，写好了代码段，代码里有 <code>StackElement</code> <code>Stack</code> <code>Teacher</code> 三个类，然后有一个 main。但是在运行时，却 Crash 了。我找了很久很久，找不到原因</p>
<h3 id="·-不会Debug怎么办？"><a href="#·-不会Debug怎么办？" class="headerlink" title="· 不会Debug怎么办？"></a>· 不会Debug怎么办？</h3><p>我用 sublime 写代码，minGW 编译运行，不懂得 C++ 怎么调试，所以我只能用笨方法去找出 Crash 的原因了：我把代码简单拆解，尝试只push是否有问题，push后只 pop 一个是否有问题。最后我发现，两次 pop 的时候就会出问题。 之后，我开始在 pop 的地方打印日志，这样我就能知道哪里出了问题了，日志的内容是 Stack 的 top 结点。结果出来了， top 结点指向了一个不曾出现的内存(为什么我知道它是不曾出现未经分配的呢？其实我也不知道，所以我在生成把有生成对象的操作的地方都打印出了对象的内存，最后发现，那个内存地址没在我的程序中被分配)。于是我就想，可能是 push 的时候出的问题？好家伙，确实是在 push 的时候出的问题，此时，我的代码长成下面的样子：</p>
<h3 id="我认为代码错误出现在…"><a href="#我认为代码错误出现在…" class="headerlink" title="- 我认为代码错误出现在…"></a>- 我认为代码错误出现在…</h3><pre><code>void push(T &amp;amp;obj) {
        StackElement&amp;lt;T&amp;gt; t;
        t.setCurrent(obj);
        t.setPrev(*top);
        top = t;
        size ++;
    }
`&lt;/pre&gt;

但是，这方法哪里出问题了？以我多年Android开发经验来看，嗯，这段代码没问题， t 是新生成的，可是，为什么打印的结果就是错的， top 一直都存在问题呢？
这一整天，我都在研究这个地方到底出了什么问题，我以为是指针出了问题， * &amp;amp; 各种换，但是，结果都不曾变过，那么，到底是哪里出啊问题？

### · 果然不懂就要问

我想去 StackOverFlow 上问一下大神们，可是我那 pool 的 英格利许 不允许我那么做，所以我硬着头皮 google 别人写的同样思路的代码，各种研究。此时，一个 Android 开发群里有人在问 Retrofit 设置 Https 证书的问题，我趁着有人开车，上车了，问了一下，才知道结果竟是如此简单！

### · 结果如此出乎意料而又在常理之中，以下为大神回答原话
</code></pre><ul>
<li>你的t是局部变量</li>
<li>那你put退出的时候，t都无效了</li>
<li>t在栈上，会继续被填充为其他数据</li>
<li>你top不会瞎指，但是指向的内容一致在瞎变</li>
<li>new 一个</li>
<li><p>必须new. const啥的，是不行的<br>What?竟然是必须要 new？不 new 的话，内存会被重复使用，所以我以为指针乱指？好滴，new一个。 结果出来了，真的是这样！！！</p>
<h3 id="·-所以呢？"><a href="#·-所以呢？" class="headerlink" title="· 所以呢？"></a>· 所以呢？</h3><p>老实说我真不会总结，所以这就是个记录，没有说明什么，我即不会在这里说new跟不new的区别 ，也不会说。。我还能说什么呢？其实我自己也不懂。<br>  讲真，局部变量如果需要重复使用，或者说要给外部使用的话，那就应该 new ，否则离开了局部，内存会被重复使用，引发奇怪的BUG出事，当然，我这还没开始考虑内存回收需要 <code>delete</code>，C++的内存管理之蛋疼可见一般！</p>
<h3 id="·-成品代码"><a href="#·-成品代码" class="headerlink" title="· 成品代码"></a>· 成品代码</h3><p><pre>`#include &lt;iostream&gt;<br>#include &lt;string&gt;</pre></p>
<p>using namespace std;</p>
<p>template &lt;class T&gt;<br>class StackElement {<br>private:</p>
<pre><code>T * current = NULL;
StackElement&amp;lt;T&amp;gt; * prev = NULL;
</code></pre><p>public:</p>
<pre><code>void setCurrent(T &amp;amp;obj) {
    current = &amp;amp;obj;
}

void setPrev(StackElement&amp;lt;T&amp;gt; &amp;amp;obj) {
    prev = &amp;amp;obj;
}

T * getCurrent() {
    return current;
}

StackElement&amp;lt;T&amp;gt; * getPrev() {
    return prev;
}
</code></pre><p>};</p>
<p>template &lt;class T&gt;<br>class Stack {<br>private:</p>
<pre><code>StackElement&amp;lt;T&amp;gt; * top = NULL;
int size;
</code></pre><p>public:</p>
<pre><code>Stack() {
    size = 0;
}
void push(T &amp;amp;obj) {
    StackElement&amp;lt;T&amp;gt; * t = new StackElement&amp;lt;T&amp;gt;;
    t -&amp;gt; setCurrent(obj);
    t -&amp;gt; setPrev(*top);
    top = t;
    size ++;
}

T * pop() {
    if (top) {
        T * result = top -&amp;gt; getCurrent();
        StackElement&amp;lt;T&amp;gt; * prev = top -&amp;gt; getPrev();
        delete top;
        if (prev) {
            top = prev;
        } else {
            top = NULL;
        }
        size --;
        return result;
    }
}

int getSize() {
    return size;
}
</code></pre><p>};</p>
<p>class Teacher {<br>private:</p>
<pre><code>string name;
</code></pre><p>public:</p>
<pre><code>Teacher(string name) {
    this -&amp;gt; name = name;
}
string getName() {
    return name;
}
void showInfo() {
    cout &amp;lt;&amp;lt; &quot;name : &quot; &amp;lt;&amp;lt; getName() &amp;lt;&amp;lt; endl;
}
~Teacher() {
    cout &amp;lt;&amp;lt; &quot;destory Teacher : &quot; &amp;lt;&amp;lt; getName() &amp;lt;&amp;lt; endl;
}
</code></pre><p>};</p>
<p>int main(){</p>
<pre><code>try {
    Teacher lee(&quot;Lee&quot;);
    Teacher tom(&quot;Tom&quot;);
    lee.showInfo();
    tom.showInfo();

    Stack&amp;lt;Teacher&amp;gt; stack;
    stack.put(lee);
    stack.put(tom);
    cout &amp;lt;&amp;lt; &quot;size : &quot; &amp;lt;&amp;lt; stack.getSize() &amp;lt;&amp;lt; endl;

    stack.push() -&amp;gt; showInfo();
    stack.push() -&amp;gt; showInfo();

    cout &amp;lt;&amp;lt; &quot;size : &quot; &amp;lt;&amp;lt; stack.getSize() &amp;lt;&amp;lt; endl;
} catch (exception&amp;amp; err) {
    cerr &amp;lt;&amp;lt; &quot;error: &quot; &amp;lt;&amp;lt; err.what() &amp;lt;&amp;lt; endl;
    return -1;
}

return 0;
</code></pre><p>}</p>
</li>
</ul>
<p>结果输出：</p>
<blockquote>
<p>name : Lee<br>  name : Tom<br>  size : 2<br>  name : Tom<br>  name : Lee<br>  size : 0<br>  destory Teacher : Tom<br>  destory Teacher : Lee</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/02/e6-b5-8b-c2-b7-listview-e5-9c-a8-e6-bb-9a-e5-8a-a8-e4-b8-ad-e5-88-87-e6-8d-a2adapter-md/" itemprop="url">
                  测 · ListView在滚动中切换Adapter
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-02T16:55:24+08:00" content="2016-06-02">
              2016-06-02
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Android笔记/" itemprop="url" rel="index">
                    <span itemprop="name">Android笔记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>像新浪微博Android端个人主页那样在滚动中切换了数据，界面还在滚动，一开始呢，我以为它自己写了控件，不过后来发现，切换Adapter就能完成了。</p>
<h3 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h3><p>公司项目里有那么几个界面很是蛋疼，具体的表现就是新浪微博Android的个人主页那样：<br>     <img src="/image/2016-06-02-16-24-15-e1464858407614.jpg" alt=""></p>
<pre><code>`新浪微博效果`
</code></pre><p>1. 有个头部，显示了用户的一些资料<br>2. 有个 tab ，用来切换内容是什么<br>3. 实验发现，内容在滚动的时候(fling)，按 tab 是可以互切的，且切完以后，界面依然还在滚动</p>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><ol>
<li>通过 Dump View Hierarchy for UI Automator，我知道新浪微博的实现似乎只通过一个 <code>ListView</code>，先当它是一个 <code>ListView</code> 完成了这个界面的主体部分吧。</li>
<li>tag 在被滚动到顶的时候，会粘在顶部，效果大概就是网上各种 <code>StikyListView</code> 的效果，做两个 tag ,分别位于顶部的 tag1 和内容上方的 tag2，监视 tag2 的位置是否已经到达界面顶部，如果已经到顶了，则显示 tag1 而隐藏 tag2</li>
<li>只有一个 ListView，内容的切换就只好通过切换 Adapter 来实现了</li>
</ol>
<h3 id="动手"><a href="#动手" class="headerlink" title="动手"></a>动手</h3><h4 id="Stiky-的效果按着原思路很容易实现，tag2-和顶部的内容放在-HeadView-里给-ListView-就好了，至于说-tag2-的位置判断，也很简单："><a href="#Stiky-的效果按着原思路很容易实现，tag2-和顶部的内容放在-HeadView-里给-ListView-就好了，至于说-tag2-的位置判断，也很简单：" class="headerlink" title="Stiky 的效果按着原思路很容易实现，tag2 和顶部的内容放在 HeadView 里给 ListView 就好了，至于说 tag2 的位置判断，也很简单："></a>Stiky 的效果按着原思路很容易实现，tag2 和顶部的内容放在 HeadView 里给 <code>ListView</code> 就好了，至于说 tag2 的位置判断，也很简单：</h4><ol>
<li><p>添加 ListView 的 OnScrollListener，在 onScroll 方法中做监听，代码如下：</p>
<p>int[] screenLocation = new int[2];<br>// tab离屏幕的距离<br>tab2.getLocationOnScreen(screenLocation);<br>int tab2Top = screenLocation[1];<br>// ListView离屏幕顶的距离<br>listView.getLocationOnScreen(screenLocation);<br>int listViewTop = screenLocation[1];</p>
<p>// tab离ListView的距离<br>int tab2Distance = -(tab2Top - listViewTop);</p>
<p>if (tab2Distance &gt; 0 || listView.getFirstVisiblePosition() &gt; 0) {<br>// &gt; 0 说明滚动超过屏幕了</p>
<pre><code>tab.setVisibility(View.VISIBLE);
tab2.setVisibility(View.INVISIBLE);
</code></pre><p>} else {</p>
<pre><code>tab.setVisibility(View.INVISIBLE);
tab2.setVisibility(View.VISIBLE);
</code></pre><p>}<br>`</p>
</li>
<li><p>接下来就是处理 <code>Adapter</code> 了， 一开始，我写了三个 <code>Adapter</code> 来做切换，最后我蛋疼的发现这样是不行的，切换的时候， <code>ListView</code> 会滚动到顶部，我最多只能通过 <code>ListView.selectionFromTop(int,int)</code> 来恢复原先滚动的进度，整体体验还算过得去，但是不符合现在的需求，于是将三个 <code>Adapter</code> 合并成一切，切换数据而不改 <code>ListView</code> 的 <code>Adapter</code>，然后用 <code>notifyDataSetChanged()</code> 方法来更新数据</p>
<ul>
<li>我原先已经为数据写好了三个 <code>Adapter</code>，这里简化为一个</li>
</ul>
<pre>`static class MyAdapter extends BaseAdapter {

        List&lt;POJO&gt; data;
        LayoutInflater mInflater;
        DisplayImageOptions dio;

        MyAdapter(Context context, List&lt;POJO&gt; data) {
            mInflater = LayoutInflater.from(context);
            if (data != null) {
                this.data = data;
            } else {
                this.data = new ArrayList&lt;POJO&gt;();
            }
            dio = new DisplayImageOptions.Builder().cacheInMemory(true).displayer(new FadeInBitmapDisplayer(200)).build();
        }

        @Override
        public int getCount() {
            return data.size();
        }

        @Override
        public POJO getItem(int position) {
            return data.get(position);
        }

        @Override
        public long getItemId(int position) {
            return 0;
        }

        @Override
        public View getView(int position, View convertView, ViewGroup parent) {
            ViewHolder holder;
            if (null == convertView) {
                convertView = mInflater.inflate(R.layout.item_listview, parent, false);
                holder = new ViewHolder(convertView);
                convertView.setTag(holder);
            } else {
                holder = (ViewHolder) convertView.getTag();
            }

            POJO pojo = getItem(position);
            holder.tv.setText(pojo.name);
            if (null != pojo.url &amp;&amp; null != holder.iv.getTag() &amp;&amp; pojo.url.equals(holder.iv.getTag())) {

            } else {
                ImageViewAware iva = new ImageViewAware(holder.iv, true);
                ImageLoader.getInstance().displayImage(pojo.url, iva, dio);
                holder.iv.setTag(pojo.url);
            }

            return convertView;
        }

    }
`</pre>

<pre>`static class ViewHolder {
        TextView tv;
        ImageView iv;

        ViewHolder(View v) {
            tv = (TextView) v.findViewById(R.id.tv);
            iv = (ImageView) v.findViewById(R.id.iv);
        }
    }
`</pre>
</li>
</ol>
<ul>
<li><p>上面说过，通过切换 Adapter 的话，感觉还不爽，于是合并成一个，这里也简单的合并了一下：</p>
<p><pre>`static class CompAdapter extends BaseAdapter {</pre></p>
<pre><code>    BaseAdapter realAdapter;
    int type;

    List&amp;lt;BaseAdapter&amp;gt; adapterList;
    CompAdapter() {
        adapterList = new ArrayList&amp;lt;BaseAdapter&amp;gt;();
    }

    public void addAdapter(BaseAdapter adapter) {
        this.adapterList.add(adapter);
    }

    public void setType(int type) {
        this.type = type;
        realAdapter = adapterList.get(type);
    }

    @Override
    public int getCount() {
        return null == realAdapter ? 0 : realAdapter.getCount();
    }

    @Override
    public Object getItem(int position) {
        return realAdapter.getItem(position);
    }

    @Override
    public long getItemId(int position) {
        return realAdapter.getItemId(position);
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        return realAdapter.getView(position, convertView, parent);
    }

    @Override
    public int getItemViewType(int position) {
        return type;
    }

    @Override
    public int getViewTypeCount() {
        return adapterList.size();
    }

}
</code></pre></li>
<li><p>现在，我用一个 <code>CompAdapter</code> 将三个 Adapter 简单的合并成一个了，<code>ListView</code> 当然是使用 <code>CompAdapter</code>了，按钮切换的时候，我就执行 <code>CompAdapter.setType(int)</code> 方法再执行  ·notifyDataSetChange()<code>方法，</code>Adapter` 的逻辑处理也就完成了，然后我们看一下效果：<br><img src="/image\2016-06-e6-b5-8b.gif" alt=""></p>
</li>
</ul>
<p>不考虑HeadView的ListView</p>
<p>嘿，任务算是完成了，很简单的方式去实现一下效果。</p>
<h3 id="Adapter方面的源码"><a href="#Adapter方面的源码" class="headerlink" title="Adapter方面的源码"></a>Adapter方面的源码</h3><p><a href="http://ofc66dujp.bkt.clouddn.com/testlistview.zip" target="_blank" rel="external">点我下载源码</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/23/fiddler-e6-8a-93genymotion-e7-9a-84-e5-8c-85/" itemprop="url">
                  Fiddler抓Genymotion的包
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-23T22:37:40+08:00" content="2016-03-23">
              2016-03-23
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Android笔记/" itemprop="url" rel="index">
                    <span itemprop="name">Android笔记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="设置-Fiddler"><a href="#设置-Fiddler" class="headerlink" title="设置 Fiddler"></a>设置 Fiddler</h4><ul>
<li>Fiddler 首先需要做设置:允许远程连接</li>
</ul>
<ol>
<li>打开窗口 Tools -&gt; Fiddler Options</li>
<li>选择 Connections标签页</li>
<li>把 Allow remote computers to connection 勾上</li>
<li>点击确定</li>
</ol>
<h4 id="设置-Genymotion"><a href="#设置-Genymotion" class="headerlink" title="设置 Genymotion"></a>设置 Genymotion</h4><ul>
<li>设置 Genymotion 的 Wifi 的代理地址为 <span style="color: red;">10.0.3.2</span>，端口设置为 <span style="color: red">8888</span> 即可</li>
</ul>
<blockquote>
<p>手机要用 Fiddler 的抓包，和 Genymotion 一样需要设置代理，不过代理地址应该设置为局域网内PC的地址</p>
</blockquote>
<hr>
<h4 id="Fiddler-使用笔记"><a href="#Fiddler-使用笔记" class="headerlink" title="Fiddler 使用笔记"></a>Fiddler 使用笔记</h4><ul>
<li>Fiddler 可以在 <a href="http://www.telerik.com/" target="_blank" rel="external">官方网站</a>下载</li>
<li>Fiddler 文档 <a href="http://docs.telerik.com/fiddler/knowledgebase/quickexec" target="_blank" rel="external">点这里查看</a></li>
<li>Fiddler 支持断点</li>
</ul>
<ol>
<li>go 可以直接继续运行所有当前因为断点而暂停的请求</li>
<li>bpu + 网址 和 bpafter + 网址 分别在请求到达服务器前和请求到达终端(手机)前进行断点，如果不加网址，则会清除对应的断点</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/01/e6-90-ad-e5-bb-ba-e8-87-aa-e5-b7-b1-e7-9a-84maven-e6-9c-8d-e5-8a-a1-e5-99-a8-e7-bb-99-e5-86-85-e9-83-a8-e9-a1-b9-e7-9b-ae-e4-bd-bf-e7-94-a8-md/" itemprop="url">
                  搭建自己的maven服务器给内部项目使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-01T10:03:25+08:00" content="2016-02-01">
              2016-02-01
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Android笔记/" itemprop="url" rel="index">
                    <span itemprop="name">Android笔记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<h2 id="服务器搭建"><a href="#服务器搭建" class="headerlink" title="服务器搭建"></a>服务器搭建</h2><h3 id="maven-服务器安装：Nexus服务器"><a href="#maven-服务器安装：Nexus服务器" class="headerlink" title="maven 服务器安装：Nexus服务器"></a>maven 服务器安装：<a href="http://www.sonatype.org/nexus/go/" target="_blank" rel="external">Nexus服务器</a></h3><ol>
<li>下载后解压，并且配置到Path中，使cmd可以直接调用</li>
<li>cmd 调用 nexus install 进行安装后 nexus start启动，即可启动服务<blockquote>
<p>解压后有sonatype-work目录，没有将会自动生成，该目录作用是配置nexus</p>
</blockquote>
</li>
</ol>
<h3 id="nexus-配置："><a href="#nexus-配置：" class="headerlink" title="nexus 配置："></a>nexus 配置：</h3><ol>
<li>nexus 默认监听8081端口，进入nexus的配置网页是：  [ip地址]:8081/nexus，本机可以直接  localhost:8081/nexus 打开配置页面，默认的配置已经足够使用</li>
<li>nexus 配置需要登录，默认的登录账户是：<br><strong>账号：admin</strong><br><strong>密码：admin123</strong></li>
</ol>
<hr>
<h2 id="将自己的代码上传到仓库"><a href="#将自己的代码上传到仓库" class="headerlink" title="将自己的代码上传到仓库"></a>将自己的代码上传到仓库</h2><h3 id="上传代码至分为，需要配置项目的build-gradle，添加一个任务："><a href="#上传代码至分为，需要配置项目的build-gradle，添加一个任务：" class="headerlink" title="上传代码至分为，需要配置项目的build.gradle，添加一个任务："></a>上传代码至分为，需要配置项目的build.gradle，添加一个任务：</h3><pre><code>apply plugin: &apos;maven&apos;

def isReleaseBuild() {
    return VERSION_NAME.contains(&quot;SNAPSHOT&quot;) == false
}
def getRepositoryUsername() {
    return hasProperty(&apos;NEXUS_USERNAME&apos;) ? NEXUS_USERNAME : &quot;&quot;
}
def getRepositoryPassword() {
    return hasProperty(&apos;NEXUS_PASSWORD&apos;) ? NEXUS_PASSWORD : &quot;&quot;
}

afterEvaluate { project -&amp;gt;
    uploadArchives {
        repositories {
            mavenDeployer {
                pom.groupId = GROUP
                pom.artifactId = ARTIFACTID
                pom.version = VERSION
                repository(url: RELEASE_REPOSITORY_URL) {
                    authentication(userName: getRepositoryUsername(), password: getRepositoryPassword())
                }
                snapshotRepository(url: SNAPSHOT_REPOSITORY_URL) {
                    authentication(userName: getRepositoryUsername(), password: getRepositoryPassword())
                }
            }
        }
    }
    task androidJavadocs(type: Javadoc) {
        options.encoding = &quot;UTF-8&quot; 
        source = android.sourceSets.main.java.srcDirs
        classpath += project.files(android.getBootClasspath().join(File.pathSeparator))
    }
    task androidJavadocsJar(type: Jar, dependsOn: androidJavadocs) {
        classifier = &apos;javadoc&apos;
        from androidJavadocs.destinationDir
    }
    task androidSourcesJar(type: Jar) {
        classifier = &apos;sources&apos;
        from android.sourceSets.main.java.sourceFiles
    }
    artifacts {
        archives androidSourcesJar
        archives androidJavadocsJar
    }
}
`&lt;/pre&gt;

&lt;font color=&quot;#FF0000&quot;&gt;options.encoding = &quot;UTF-8&quot; 指定了maven的编码，windows下如果不指定可能会导致 javadoc导出的时候出现错误&lt;/font&gt;

### 配置Gradle的参数，在gradle.properties添加代码&lt;/fontstyle &gt;

&lt;pre&gt;`GROUP=分组名
ARTIFACTID=项目名
VERSION=版本名称

SNAPSHOT_REPOSITORY_URL=http://localhost:8081/nexus/content/repositories/snapshots/
RELEASE_REPOSITORY_URL=http://localhost:8081/nexus/content/repositories/releases/

NEXUS_USERNAME=rksocket
NEXUS_PASSWORD=123456
`&lt;/pre&gt;

* * *

## 使用maven私服的库

### 添加库地址

&lt;pre&gt;`dependencies{
        repositories {
        maven {url &quot;http://localhost:8081/nexus/content/repositories/releases&quot;}
        maven {url &quot;http://localhost:8081/nexus/content/repositories/snapshots&quot;}
    }    
}
`&lt;/pre&gt;

### 引用库和普通的gradle库一样使用

&lt;pre&gt;`compile &apos;分组名:项目名:版本名称&apos;
</code></pre><h3 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h3><p><a href="http://blog.csdn.net/l2show/article/details/48653949" target="_blank" rel="external">Linux下部署Nexus服务器及在AS中的使用</a><br><a href="http://my.oschina.net/liangbo/blog/195739?fromerr=k9pnb4x9" target="_blank" rel="external">Windows下部署Nexus服务器</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/01/22/javaandroid-e7-9a-84-e5-8a-a0-e5-af-86-e8-a7-a3-e5-af-86/" itemprop="url">
                  Java&Android的加密解密
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-01-22T14:03:56+08:00" content="2016-01-22">
              2016-01-22
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Android笔记/" itemprop="url" rel="index">
                    <span itemprop="name">Android笔记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>通过 RSA 加密解密，同理可以进行 MD5 和 SHA 值的计算，注意使用的包是 javax.crypto(加密解密)、java.security(密钥生成获取，MD5计算等)。<br>主要的类是 KeyPairGenerator、 KeyPair、 PublicKey、 PrivateKey、 KeyFactory、 Cipher等</strong></p>
<ul>
<li><p>以下为使用RSA进行的加密demo</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">    <span class="comment">/**************************************</span></div><div class="line">     * 生成密钥以供加密解密                                   *</div><div class="line">     **************************************/</div><div class="line">    <span class="comment">/* 密钥生成器 */</span></div><div class="line">    KeyPairGenerator generator = KeyPairGenerator.getInstance(“RSA”);</div><div class="line">    <span class="comment">/* 密钥对生成 */</span></div><div class="line">    KeyPair keyPair = generator.genKeyPair();</div><div class="line">    <span class="comment">/* 获取公钥 */</span></div><div class="line">    RSAPublicKey publicKey = (RSAPublicKey)keyPair.getPublic();</div><div class="line">    <span class="comment">/* 获取私钥 */</span></div><div class="line">    RSAPrivateKey privateKey = (RSAPrivateKey)keyPair.getPrivate();</div><div class="line">    <span class="comment">/* 获取密钥的 Modules 和 Exponent 值以供密钥还原 */</span></div><div class="line">    BigInteger publicModules = publicKey.getModulus();</div><div class="line">    BigInteger privateModules = privateKey.getModulus();</div><div class="line">    BigInteger publicExponent = publicKey.getPublicExponent();</div><div class="line">    BigInteger privateExponent = privateKey.getPrivateExponent();</div><div class="line">    System.out.println(“Public Modules == “ + publicModules);</div><div class="line">    System.out.println(“Private Modules == “ + privateModules);</div><div class="line">    System.out.println(“Public Exponent == “ + publicExponent);</div><div class="line">    System.out.println(“Private Exponent == “ + privateExponent);</div><div class="line">    <span class="comment">/**************************************</span></div><div class="line">     * 通过 modules 和 exponent 还原密钥          *</div><div class="line">     **************************************/</div><div class="line">    <span class="comment">/* 通过 Modules 和 Exponent 值生成 KeySpec */</span></div><div class="line">    RSAPublicKeySpec publicSpec = <span class="keyword">new</span> RSAPublicKeySpec(publicModules, publicExponent);</div><div class="line">    RSAPrivateKeySpec privateSpec = <span class="keyword">new</span> RSAPrivateKeySpec(privateModules, privateExponent);</div><div class="line">    <span class="comment">/* 通过 KeySpec还原密钥，还原工具是 KeyFactory */</span></div><div class="line">    KeyFactory keyFactory = KeyFactory.getInstance(“RSA”);</div><div class="line">    RSAPublicKey rPublicKey = <span class="keyword">null</span>;</div><div class="line">    RSAPrivateKey rPrivateKey = <span class="keyword">null</span>;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        rPublicKey = (RSAPublicKey) keyFactory.generatePublic(publicSpec);</div><div class="line">        rPrivateKey = (RSAPrivateKey) keyFactory.generatePrivate(privateSpec);</div><div class="line">    &#125; <span class="keyword">catch</span> (InvalidKeySpecException e) &#123;</div><div class="line">        <span class="comment">// TODO Auto-generated catch block</span></div><div class="line">        e.printStackTrace();</div><div class="line">    &#125;</div><div class="line">    <span class="comment">/**************************************</span></div><div class="line">     * 通过密钥进行简单的加密解密测试                  *</div><div class="line">     * 加密解密使用Cipher类进行                           *</div><div class="line">     **************************************/</div><div class="line">    String secret = “这是一个秘密，不允许无关人士查看”;</div><div class="line">    <span class="keyword">byte</span>[] bSecret = secret.getBytes();</div><div class="line">    <span class="keyword">byte</span>[] dSecret = <span class="keyword">null</span>;</div><div class="line">    System.out.print(“加密前<span class="keyword">byte</span>数组：”);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">byte</span> b : bSecret) &#123;</div><div class="line">        System.out.print(b);</div><div class="line">    &#125;</div><div class="line">    System.out.println();</div><div class="line">    System.out.println(“加密前： “ + <span class="keyword">new</span> String(bSecret));</div><div class="line">    <span class="comment">/* Cipher加密数据及还原数据 */</span></div><div class="line">    Cipher cipher = Cipher.getInstance(“RSA/ECB/PKCS1Padding”);</div><div class="line">    <span class="comment">/* 加密初始化，通过私钥加密，指定的参数决定了加密还是解密 */</span></div><div class="line">    cipher.init(Cipher.ENCRYPT_MODE, privateKey);</div><div class="line">    <span class="comment">/* 可以通过 doFinal 或 update 进行加解密，String太短使用update可能会失败，可以选择 onFinal */</span></div><div class="line">    dSecret = cipher.doFinal(bSecret);</div><div class="line">    System.out.print(“加密后<span class="keyword">byte</span>数组： “);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">byte</span> b : dSecret) &#123;</div><div class="line">        System.out.print(b);</div><div class="line">    &#125;</div><div class="line">    System.out.println();</div><div class="line">    System.out.println(“加密后: “ + <span class="keyword">new</span> String(dSecret));</div><div class="line">    <span class="comment">/* 重新初始化进行解密，参数为DECRYPT_MODE */</span></div><div class="line">    cipher.init(Cipher.DECRYPT_MODE, publicKey);</div><div class="line">    dSecret = cipher.doFinal(dSecret);</div><div class="line">    System.out.print(“解密后<span class="keyword">byte</span>数组： “);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">byte</span> b : dSecret) &#123;</div><div class="line">        System.out.print(b);</div><div class="line">    &#125;</div><div class="line">    System.out.println();</div><div class="line">    System.out.println(“解密后: “ + <span class="keyword">new</span> String(dSecret));</div><div class="line">    <span class="comment">/**************************************</span></div><div class="line">     * 计算MD5值                                                      *</div><div class="line">     * 使用  MessageDigest计算                            *</div><div class="line">     **************************************/</div><div class="line">    <span class="comment">/* MessageDigest 计算 MD5 值，参数输入 SHA1 则是计算 SHA1 值，MD5为32位，SHA1为40位 */</span></div><div class="line">    MessageDigest digest = MessageDigest.getInstance(“MD5”);</div><div class="line">    <span class="comment">/* 计算 */</span></div><div class="line">    digest.update(bSecret);</div><div class="line">    <span class="comment">/* 取结果 */</span></div><div class="line">    dSecret = digest.digest();</div><div class="line">    <span class="comment">/* 处理数组，把byte数组转为16进制字符串 */</span></div><div class="line">    StringBuilder md5 = <span class="keyword">new</span> StringBuilder();</div><div class="line">    <span class="comment">/* 二进制转十六进制，先把二进制转成十进制，再从数组中取对应的char */</span></div><div class="line">    <span class="keyword">char</span>[] hexDigits = &#123;‘<span class="number">0</span>’, ‘<span class="number">1</span>’, ‘<span class="number">2</span>’, ‘<span class="number">3</span>’, ‘<span class="number">4</span>’, ‘<span class="number">5</span>’, ‘<span class="number">6</span>’, ‘<span class="number">7</span>’, ‘<span class="number">8</span>’, ‘<span class="number">9</span>’, ‘a’, ‘b’, ‘c’, ‘d’, ‘e’, ‘f’&#125;;</div><div class="line">    <span class="keyword">byte</span> b;</div><div class="line">    <span class="keyword">char</span> hex;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; dSecret.length; i ++) &#123;</div><div class="line">        b = dSecret[i];</div><div class="line">        <span class="comment">/*</span></div><div class="line">         * 取byte二进制的4位出来计算成16进制 ，</div><div class="line">         * 系统将二进制转10进制，再去从hexDigits中找出对应的16进制char就实现了二进制转16进制</div><div class="line">         * 0xf是16进制中的16，在二进制中是1111，byte和二进制的1111进行运算得到byte中低四位的二进制值</div><div class="line">         * 16位是取32位中间16位</div><div class="line">         */</div><div class="line">        hex = hexDigits[b &gt;&gt;&gt; <span class="number">4</span> &amp; <span class="number">0xf</span>];</div><div class="line">        md5.append(hex);</div><div class="line">        <span class="comment">/* 如果是32位md5字符串则需要以下 */</span></div><div class="line">        hex = hexDigits[b &amp; <span class="number">0xf</span>];</div><div class="line">        md5.append(hex);</div><div class="line">    &#125;</div><div class="line">    System.out.println(“<span class="number">32</span>位md5 == “ + md5);</div><div class="line">    System.out.println(“<span class="number">16</span>位md5 == “ + md5.substring(<span class="number">8</span>, <span class="number">24</span>));</div><div class="line">&#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</div><div class="line">    <span class="comment">// TODO Auto-generated catch block</span></div><div class="line">    e.printStackTrace();</div><div class="line">&#125; <span class="keyword">catch</span> (NoSuchPaddingException e) &#123;</div><div class="line">    <span class="comment">// TODO Auto-generated catch block</span></div><div class="line">    e.printStackTrace();</div><div class="line">&#125; <span class="keyword">catch</span> (InvalidKeyException e) &#123;</div><div class="line">    <span class="comment">// TODO Auto-generated catch block</span></div><div class="line">    e.printStackTrace();</div><div class="line">&#125; <span class="keyword">catch</span> (IllegalBlockSizeException e) &#123;</div><div class="line">    <span class="comment">// TODO Auto-generated catch block</span></div><div class="line">    e.printStackTrace();</div><div class="line">&#125; <span class="keyword">catch</span> (BadPaddingException e) &#123;</div><div class="line">    <span class="comment">// TODO Auto-generated catch block</span></div><div class="line">    e.printStackTrace();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>AES进行文件加密：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">  <span class="comment">/*****************</span></div><div class="line">   * AES数据加密    *</div><div class="line">   *****************/</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">      String ab = “我只是要做一下测试而已，不至于 吧？”;</div><div class="line">      String file = “C:<span class="comment">//users/admin/Desktop/test”;</span></div><div class="line">      <span class="comment">/* 密钥生成器 */</span></div><div class="line">      KeyGenerator kg = KeyGenerator.getInstance(“AES”);</div><div class="line">      <span class="comment">/* 初始化密钥生成器，AES长度必须是128、256、512中的一个 */</span></div><div class="line">      kg.init(<span class="number">128</span>, <span class="keyword">new</span> SecureRandom(“<span class="number">12134</span>”.getBytes()));</div><div class="line">      <span class="comment">/* 生成密钥 */</span></div><div class="line">      SecretKey sk = kg.generateKey();</div><div class="line">      <span class="comment">/* 得到密钥的Spec */</span></div><div class="line">      <span class="comment">// SecretKeySpec sks = new SecretKeySpec(sk.getEncoded(), “AES”);</span></div><div class="line">      <span class="comment">/* 得到加密工具 Cipher，以 AES为算法 ，ECB为模式， PKCS5Padding为填充模式 */</span></div><div class="line">      Cipher cipher = Cipher.getInstance(“AES/ECB/PKCS5Padding”);</div><div class="line">      <span class="comment">/* 初始化加密工具 */</span></div><div class="line">      cipher.init(Cipher.ENCRYPT_MODE, sk);</div><div class="line">      <span class="comment">/* 文件流 */</span></div><div class="line">      FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(file);</div><div class="line">      <span class="comment">/* 使用加密流包装文件流 */</span></div><div class="line">      CipherOutputStream cos = <span class="keyword">new</span> CipherOutputStream(fos, cipher);</div><div class="line">      <span class="comment">/* 写出数据 */</span></div><div class="line">      cos.write(ab.getBytes());</div><div class="line">      <span class="comment">/* 刷新流 */</span></div><div class="line">      cos.flush();</div><div class="line">      cos.close();</div><div class="line">      <span class="comment">/* 初始化加密工具为解密 */</span></div><div class="line">      cipher.init(Cipher.DECRYPT_MODE, sk);</div><div class="line">      <span class="comment">/* 文件输入流 */</span></div><div class="line">      FileInputStream fis = <span class="keyword">new</span> FileInputStream(file);</div><div class="line">      <span class="comment">/* 使用加密流包装文件输入流 */</span></div><div class="line">      CipherInputStream cis = <span class="keyword">new</span> CipherInputStream(fis, cipher);</div><div class="line">      <span class="comment">/* 读取文件数据，解密并且转为String */</span></div><div class="line">      <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</div><div class="line">      <span class="keyword">int</span> len = <span class="number">0</span>;</div><div class="line">      ByteArrayOutputStream baos = <span class="keyword">new</span> ByteArrayOutputStream();</div><div class="line">      <span class="keyword">while</span>( (len = cis.read(buf)) != -<span class="number">1</span>) &#123;</div><div class="line">          baos.write(buf, <span class="number">0</span>, len);</div><div class="line">      &#125;</div><div class="line">      System.out.println(<span class="keyword">new</span> String(baos.toByteArray()));</div><div class="line">      cis.close();</div><div class="line">  &#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">      <span class="comment">// TODO Auto-generated catch block</span></div><div class="line">      e.printStackTrace();</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/12/30/e8-87-aa-e5-ae-9a-e4-b9-89spinner-e5-bc-b9-e6-a1-86-e7-9a-84-e5-8a-a8-e7-94-bb-2/" itemprop="url">
                  自定义Spinner弹框的动画
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-12-30T13:46:24+08:00" content="2015-12-30">
              2015-12-30
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Android笔记/" itemprop="url" rel="index">
                    <span itemprop="name">Android笔记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>有人问了这样的问题，就试验看看了。<br>发现Spinner并没有提供这样的类似于 Activity.overridePendingTransition 这样自定义动画的方法，去瞅了眼源码，发现源码里，Spinner里的PopupWindow/Dialog都是内部定义的类，群里的朋友问的是PopupWindow展示的方式的，所以试验了PopupWindow的方案。<br>既然没有找到源码，那就只好寻找其他方案了，getPopupContext的API等级在23，不能通过这个来改变动画，于是考虑使用style设置默认的来做，但是popupwindow是在Spinner内部构建的，最后解决方案是在style中去写。</p>
<h5 id="先为PopupWindow准备了打开和关闭的两个动画xml："><a href="#先为PopupWindow准备了打开和关闭的两个动画xml：" class="headerlink" title="先为PopupWindow准备了打开和关闭的两个动画xml："></a>先为PopupWindow准备了打开和关闭的两个动画xml：</h5><ul>
<li><p>popup_enter.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">scale</span></span></div><div class="line">        <span class="attr">android:fromXScale</span>=<span class="string">"1.0"</span></div><div class="line">        <span class="attr">android:toXScale</span>=<span class="string">"1.0"</span></div><div class="line">        <span class="attr">android:fromYScale</span>=<span class="string">"0.6"</span></div><div class="line">        <span class="attr">android:toYScale</span>=<span class="string">"1.0"</span></div><div class="line">        <span class="attr">android:pivotX</span>=<span class="string">"50%"</span></div><div class="line">        <span class="attr">android:pivotY</span>=<span class="string">"0%"</span></div><div class="line">        <span class="attr">android:duration</span>=<span class="string">"1000"</span> /&gt;</div><div class="line">    <span class="tag">&lt;<span class="name">alpha</span> <span class="attr">android:interpolator</span>=<span class="string">"@android:anim/decelerate_interpolator"</span></span></div><div class="line">        <span class="attr">android:fromAlpha</span>=<span class="string">"0.0"</span></div><div class="line">        <span class="attr">android:toAlpha</span>=<span class="string">"1.0"</span></div><div class="line">        <span class="attr">android:duration</span>=<span class="string">"1000"</span></div><div class="line">        /&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>popup_exit.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">scale</span></span></div><div class="line">        <span class="attr">android:fromXScale</span>=<span class="string">"1.0"</span></div><div class="line">        <span class="attr">android:toXScale</span>=<span class="string">"1.0"</span></div><div class="line">        <span class="attr">android:fromYScale</span>=<span class="string">"1.0"</span></div><div class="line">        <span class="attr">android:toYScale</span>=<span class="string">"0.5"</span></div><div class="line">        <span class="attr">android:pivotX</span>=<span class="string">"50%"</span></div><div class="line">        <span class="attr">android:pivotY</span>=<span class="string">"0%"</span></div><div class="line">        <span class="attr">android:duration</span>=<span class="string">"500"</span> /&gt;</div><div class="line">    <span class="tag">&lt;<span class="name">alpha</span></span></div><div class="line">        <span class="attr">android:interpolator</span>=<span class="string">"@android:anim/accelerate_interpolator"</span></div><div class="line">        <span class="attr">android:fromAlpha</span>=<span class="string">"1.0"</span></div><div class="line">        <span class="attr">android:toAlpha</span>=<span class="string">"0.0"</span></div><div class="line">        <span class="attr">android:duration</span>=<span class="string">"500"</span> /&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="style中添加一下PopupWindow要使用的样式"><a href="#style中添加一下PopupWindow要使用的样式" class="headerlink" title="style中添加一下PopupWindow要使用的样式:"></a>style中添加一下PopupWindow要使用的样式:</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"CustomPopupTheme"</span> <span class="attr">parent</span>=<span class="string">"AppTheme"</span>&gt;</span><span class="xml"></span></div><div class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:popupAnimationStyle"</span>&gt;</span>@style/PopupAnimation<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"PopupAnimation"</span> <span class="attr">parent</span>=<span class="string">"android:Animation"</span> <span class="attr">mce_bogus</span>=<span class="string">"1"</span>&gt;</span><span class="xml"></span></div><div class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:windowEnterAnimation"</span>&gt;</span>@anim/popup_enter<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:windowExitAnimation"</span>&gt;</span>@anim/popup_exit<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div></pre></td></tr></table></figure>
<h5 id="在Spinner控件里去使用它："><a href="#在Spinner控件里去使用它：" class="headerlink" title="在Spinner控件里去使用它："></a>在Spinner控件里去使用它：</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Spinner</span></span></div><div class="line">    <span class="attr">android:id</span>=<span class="string">"@+id/spinner"</span></div><div class="line">    <span class="attr">style</span>=<span class="string">"@style/CustomPopupTheme"</span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">    <span class="attr">android:spinnerMode</span>=<span class="string">"dropdown"</span></div><div class="line">    /&gt;</div></pre></td></tr></table></figure>
<h5 id="然后就搞定了，效果："><a href="#然后就搞定了，效果：" class="headerlink" title="然后就搞定了，效果："></a>然后就搞定了，效果：</h5><p><img src="/image/a4c25fdd22454bf525d26ed4c057cf85_Video_2015-12-30_131550.gif" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/12/25/windows-cmd-e7-aa-97-e5-91-bd-e4-bb-a4/" itemprop="url">
                  windows CMD窗命令
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-12-25T16:21:54+08:00" content="2015-12-25">
              2015-12-25
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Android笔记/" itemprop="url" rel="index">
                    <span itemprop="name">Android笔记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>stikynot win7自带的便笺</li>
<li>journal 可以直接打开win7的日记本(不是记事本)</li>
<li>tabtip 可以打开一个“鼠标手写板”，可以用来写字，而且识别效果不错</li>
<li>snippingtool 一个自带的截图工具，完成后可以直接在画板里打开</li>
<li>write （writepad） 手写板，与word差不多，可以保存成 .docx 文档！</li>
<li>robocopy 多线程拷贝，命令比较复杂，到 cmd 去执行吧，-mt::线程数 设置线程数 -s 复制子目录不包括空目录 -e 复制子目录包括空目录 -mir则是保留文件夹树</li>
<li>mspaint 画板</li>
</ul>
<p><code>netstat -aon|findstr 5037 // 查看当前的端口占用（findStr跟linux 的 grep差不多，5037是adb）
tasklist|findstr 5037 // tasklist 就是任务列表
taskkill /f /t /im adb.exe // 强制终止任务， /f是强制 /t 是任务进程及其子进程 /im 是映像等</code></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/12/22/hosts/" itemprop="url">
                  Hosts
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-12-22T23:25:06+08:00" content="2015-12-22">
              2015-12-22
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/杂谈/" itemprop="url" rel="index">
                    <span itemprop="name">杂谈</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>总有些网站特别难上去，也许是GFW，也许是DNS堵塞。通常的番羽墙我用自己的ss，不过有的时候，改下hosts就能稳定的上了(比如我用长城宽带，DNS太不给力了，github上不去)，那么，hosts设置一下加快网页打开的速度吧。</p>
<p>在ping.pe或<a href="http://ping.chinaz.com/来找到对应的IP，然后添加到" target="_blank" rel="external">http://ping.chinaz.com/来找到对应的IP，然后添加到</a> C:\Windows\System32\drivers\etc\hosts</p>
<blockquote>
<p>185.31.16.184 github.global.ssl.fastly.net</p>
<p>192.30.252.130 github.com.</p>
<p>192.30.252.141 gist.github.com<br>推荐个会更新Google hosts的博客：<a href="http://laod.cn/hosts/2015-google-hosts.html" target="_blank" rel="external">http://laod.cn/hosts/2015-google-hosts.html</a></p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/12/14/e9-80-9a-e8-bf-87-e7-8e-b0-e6-9c-89-e7-9a-84type-e6-88-96-e8-80-85-e6-b3-9b-e5-9e-8b-e8-8e-b7-e5-8f-96-e5-88-b0-e4-b8-80-e4-b8-aalist-e5-b0-81-e8-a3-85-e8-b5-b7-e6-9d-a5-e7-9a-84-e6-96-b0type-2/" itemprop="url">
                  通过现有的Type或者泛型获取到一个List封装起来的新Type
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-12-14T10:42:29+08:00" content="2015-12-14">
              2015-12-14
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Android笔记/" itemprop="url" rel="index">
                    <span itemprop="name">Android笔记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在Bean里写getListType()累了，终于发现有方法取代了<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 通过泛型获取到泛型对应的  List 列表的Type，以便Gson可以解析</div><div class="line"> * <span class="doctag">@param</span> subclass class xxx&lt;T&gt; 里面的这个xxx.getClass()</div><div class="line"> * <span class="doctag">@return</span></div><div class="line">    */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Type <span class="title">getListTypeFromGeneric</span><span class="params">(Class&lt;?&gt; subclass)</span> </span>&#123;</div><div class="line">   <span class="comment">// 获取类对应的类型，比如说在RecyclerViewFragment&lt;DuiTangInfo&gt;，则将得到RecyclerViewFragment&lt;DuiTangInfo&gt;</span></div><div class="line">   Type superclass = subclass.getGenericSuperclass();</div><div class="line">   <span class="keyword">if</span> (superclass <span class="keyword">instanceof</span> Class) &#123;</div><div class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Missing type parameter."</span>);</div><div class="line">   &#125;</div><div class="line">   ParameterizedType parameter = (ParameterizedType) superclass;</div><div class="line">   <span class="comment">// 取得泛型类型对应的类型，即得到 DuiTangInfo 最后对应的类型</span></div><div class="line">   Type _type = $Gson$Types.canonicalize(parameter.getActualTypeArguments()[<span class="number">0</span>]);</div><div class="line">   <span class="comment">// 生成被 List 所包含的 Type</span></div><div class="line">   <span class="keyword">return</span> $Gson$Types.newParameterizedTypeWithOwner(<span class="keyword">null</span>, List.class, _type);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 通过已有的 &#123;<span class="doctag">@link</span> Type&#125; 获取到泛型对应的  List 列表的Type，以便Gson可以解析</div><div class="line"> * <span class="doctag">@param</span> type</div><div class="line"> * <span class="doctag">@return</span></div><div class="line">    */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Type <span class="title">getListTypeFromType</span><span class="params">(Type type)</span> </span>&#123;</div><div class="line">   <span class="keyword">return</span> $Gson$Types.newParameterizedTypeWithOwner(<span class="keyword">null</span>, List.class, type);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p></p>
<div>参考资料:  <a href="https://github.com/ZhaoKaiQiang/OkHttpPlus/blob/master/library/src/main/java/com/socks/okhttp/plus/parser/OkBaseJsonParser.java" target="_blank" rel="external">https://github.com/ZhaoKaiQiang/OkHttpPlus/blob/master/library/src/main/java/com/socks/okhttp/plus/parser/OkBaseJsonParser.java</a></div><br><div><span style="font-family: 微软雅黑;">                 <a href="https://github.com/google/gson/blob/master/gson/src/main/java/com/google/gson/internal/%24Gson%24Types.java" target="_blank" rel="external">https://github.com/google/gson/blob/master/gson/src/main/java/com/google/gson/internal/%24Gson%24Types.java</a> </span></div>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Eraise" />
          <p class="site-author-name" itemprop="name">Eraise</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">19</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">34</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Eraise</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  

</body>
</html>
