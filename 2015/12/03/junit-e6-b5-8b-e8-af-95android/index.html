<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="Eraise"><meta name="description" content="Junit(单元测试)，好吧，我看啊看我依然不明白它有什么作用。只是对于单一的方法或许可以一测吧。每个JUnit测试都可以包含：测试前环境配置–&amp;gt;测试用例–&amp;gt;测试后资源重置。在看Android之前的，就先看看Java的吧，Java的比较简单，使用的是JU"><meta name="keywords" content="Android,Instrument,JUnit"><title>Junit 测试Android · 我吃西瓜</title><link rel="icon" href="/favicon.ico"><link rel="canonical" href="http://eraise.xyz/2015/12/03/junit-e6-b5-8b-e8-af-95android/"><link rel="alternate" href="/atom.xml" title="我吃西瓜"><link rel="stylesheet" href="/fonts/iconfont/iconfont.css"><link rel="stylesheet" href="/css/style.css"><script type="text/javascript">var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?92ceb44df626dd88b7190057da6f94e0";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script type="text/javascript">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'Your Google Analytics ID', 'auto');
ga('send', 'pageview');</script></head><body><div id="main"><header><a href="/." class="logo">我吃西瓜</a><ul class="nav"><li class="nav-link"><a href="/" target="_self">主页</a></li><li class="nav-link"><a href="/archives" target="_self">文章</a></li><li class="nav-link"><a href="/categories" target="_self">分类</a></li><li class="nav-link"><a href="/tags" target="_self">标签</a></li></ul></header><section id="container"><article class="post"><h1 class="post-title">Junit 测试Android</h1><span class="post-time">2015年12月3日</span><div class="post-content"><p><del>Junit(单元测试)，好吧，我看啊看我依然不明白它有什么作用。只是对于单一的方法或许可以一测吧。</del></p>
<p><strong>每个JUnit测试都可以包含：测试前环境配置  –&gt; 测试用例 –&gt; 测试后资源重置。</strong></p>
<p>在看Android之前的，就先看看Java的吧，Java的比较简单，使用的是JUnit 4做的测试，在使用Eclipse的时候可以自动添加JUnit 4环境。</p>
<p>Java的JUnit测试主要就是使用注解 @Test 注解一个方法表明该方法是一个测试用例，用 @After 注解来对 @Test 方法运行完进行后续处理， @Befor 注解对 @Test 方法运行前进行预先的配置处理，不需要西继承什么类了。Java在Eclipse中在运行的时候选择JUnit就可以进行JUnit测试了。在视图里可以找到”JUnit”来查看结果。</p>
<a id="more"></a>
<ol>
<li><p>先创建一个被测试的类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JunitTest</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> arg1, <span class="keyword">int</span> arg2)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> arg1 + arg2;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sub</span><span class="params">(<span class="keyword">int</span> arg1, <span class="keyword">int</span> arg2)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> arg1 – arg2;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>编写测试代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTestCase</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> arg1 = <span class="number">10</span>;</div><div class="line">    <span class="keyword">int</span> arg2 = <span class="number">3</span>;</div><div class="line">    <span class="keyword">int</span> r1 = <span class="number">13</span>;</div><div class="line">    <span class="keyword">int</span> r2 = <span class="number">7</span>;</div><div class="line">    JunitTest jt = <span class="keyword">null</span>;</div><div class="line"></div><div class="line">    <span class="meta">@Before</span></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 每个测试用例被调用前调用</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</div><div class="line">        jt = <span class="keyword">new</span> JunitTest();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 测试用例</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAdd</span><span class="params">()</span> </span>&#123;</div><div class="line">        assertTrue(“That is”, jt.add(arg1, arg2) == r1);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 测试用例</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSub</span><span class="params">()</span> </span>&#123;</div><div class="line">        assertTrue(“sub is”, jt.sub(arg1, arg2) == r2);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@After</span></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 每个测试用例被调用后调用</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">end</span><span class="params">()</span> </span>&#123;</div><div class="line">        System.out.println(“Test finish”);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<p>Android在SDK1.5后提供了JUnit测试，Android的 JUnit 测试需要继承 TestCase 类，并且需要在ManiFest.xml中进行配置，可以写一个类，内部包含一个 <code>public static Test suite(){}</code> 方法来管理测试用例类。Android的JUnit可以是没有界面的(JUnit隐藏掉界面)，不过像下面这样的例子，跟Java基本上就是一致的，这也是最简单的用例。Android与JUnit的结合核心或许是在 <code>BaseTestRunner</code> 类和 <code>AndroidTestRunner</code> 类(junit.runner包)。默认的安卓会有一个<code>BaseTestRunner</code>来帮助我们运行代码，我们也可以通过自己去实例化一个<code>AndroidTestRunner</code>和实现自己的<code>TestListener</code>来做测试。</p>
<p><strong>在Android里，可以用 Dev Tools(AVD中的APP) –&gt; Instrumentation –&gt; instrumentation结点中的 label 来测试</strong></p>
<blockquote>
<p>Android的JUnit集成在内部，所以可以在API文档中查到相关的包、类等。Android中的JUnit包括如下的包：</p>
</blockquote>
<table>
<thead>
<tr>
<th>SDK</th>
<th>功能说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>junit.framework</code></td>
<td>JUnit测试框架</td>
</tr>
<tr>
<td><code>junit.runner</code></td>
<td>实用工具类支持JUnit测试框架</td>
</tr>
<tr>
<td><code>android.test</code></td>
<td>Android 对JUnit测试框架的扩展包</td>
</tr>
<tr>
<td><code>android.test.mock</code></td>
<td>Android的一些辅助类</td>
</tr>
<tr>
<td><code>android.test.suitebuilder</code></td>
<td>实用工具类，支持类的测试运行</td>
</tr>
</tbody>
</table>
<ol>
<li><p>Manifest.xml要在 application 后面添加 instrumentation 结点，在 application 里添加 user-library， 配置是通用的。</p>
<ul>
<li><p>instrumentation 结点内容是：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">instrumentation</span></span></div><div class="line">    <span class="attr">android:name</span>=<span class="string">“android.test.InstrumentationTestRunner”</span></div><div class="line">    <span class="attr">android:targetPackage</span>=<span class="string">“com.eraise.androidjunittest”</span></div><div class="line">    /&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>user-library 结点的内容是：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">uses-library</span> <span class="attr">android:name</span>=<span class="string">“android.test.runner”</span> /&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>Manifest 修改完后长这样：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=“1.0” encoding=“utf-8”?&gt;</div><div class="line"> &lt;manifest xmlns:android=“http://schemas.android.com/apk/res/android”</div><div class="line"> package=“com.eraise.androidjunittest”</div><div class="line"> android:versionCode=“1”</div><div class="line"> android:versionName=“1.0” &gt;</div><div class="line"> &lt;uses-sdk</div><div class="line">     android:minSdkVersion=“8”</div><div class="line">     android:targetSdkVersion=“18” /&gt;</div><div class="line"> &lt;application</div><div class="line">     android:allowBackup=“true”</div><div class="line">     android:icon=“@drawable/ic_launcher”</div><div class="line">     android:label=“@string/app_name”</div><div class="line">     android:theme=“@style/AppTheme” &gt;</div><div class="line">     &lt;activity</div><div class="line">         android:name=“com.eraise.androidjunittest.JunitTestActivity”</div><div class="line">         android:label=“@string/app_name” &gt;</div><div class="line">         &lt;intent-filter&gt;</div><div class="line">             &lt;action android:name=“android.intent.action.MAIN” /&gt;</div><div class="line">             &lt;category android:name=“android.intent.category.LAUNCHER” /&gt;</div><div class="line">         &lt;/intent-filter&gt;</div><div class="line">     &lt;/activity&gt;</div><div class="line">     &lt;uses-library android:name=“android.test.runner” /&gt;</div><div class="line"> &lt;/application&gt;</div><div class="line"></div><div class="line"> &lt;instrumentation</div><div class="line">     android:name=“android.test.InstrumentationTestRunner”</div><div class="line">     android:targetPackage=“com.eraise.androidjunittest” &lt;!– 指定要测试的包 –&gt;</div><div class="line">     android:label=“com.eraise.AndroidJUnitTest”</div><div class="line">     /&gt;</div><div class="line"></div><div class="line">&lt;/manifest&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>测试的对象跟Java一样，先写一个被测试的类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SampleCalcutor</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> arg1, <span class="keyword">int</span> arg2)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> arg1 + arg2;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sub</span><span class="params">(<span class="keyword">int</span> arg1, <span class="keyword">int</span> arg2)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> arg1 – arg2;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>测试类继承于 TestCase，其中的 setUp() 方法在测试样例被调用前调用，可用于环境配置， tearDown() 方法在测试样例调用结束后调用，可用于资源回收， 测试样例只需要是以 test 开头就可以被检查出来(相应的也就是说，test开头的方法都将被当成测试用例)：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyJUnitTest</span> <span class="keyword">extends</span> <span class="title">TestCase</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> arg1 = <span class="number">10</span>;</div><div class="line">    <span class="keyword">int</span> arg2 = <span class="number">3</span>;</div><div class="line">    <span class="keyword">int</span> r1 = <span class="number">13</span>;</div><div class="line">    <span class="keyword">int</span> r2 = <span class="number">7</span>;</div><div class="line">    SampleCalcutor sc = <span class="keyword">null</span>;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 每个测试样例调用前调用，可以用于环境配置</div><div class="line">     */</div><div class="line">     <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        <span class="keyword">super</span>.setUp();</div><div class="line">        sc = <span class="keyword">new</span> SampleCalcutor();</div><div class="line">        System.out.println(“测试前”);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 每个测试样例结束后调用，可以用于资源的回收</div><div class="line">     */</div><div class="line">     <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">tearDown</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        <span class="keyword">super</span>.tearDown();</div><div class="line">        System.out.println(“测试完”);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 测试用例1</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAdd</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> result = sc.add(arg1, arg2);</div><div class="line">        assertTrue(“add result is “, result == r1);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 测试用例2</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSub</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> result = sc.sub(arg1, arg2);</div><div class="line">        assertTrue(“subtract result is “, result == r2);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>以上已经可以运行了，通过右键项目 — Run As –&gt; Android JUnit Test， 不过这样如果有多个 TestCase ，就都会被运行出来，所以我们可以用一个拥有 public static Test suite(){} 的类来运行，使用 TestSuite 管理 TestSuite.addTestSuite() 添加需要测试的用例类：</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestAll</span> </span>&#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 管理测试用例，直接在TestAll右键以Android JUnit方式运行</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Test <span class="title">suite</span><span class="params">()</span> </span>&#123;</div><div class="line">        TestSuite suite = <span class="keyword">new</span> TestSuite();</div><div class="line">        suite.addTestSuite(MyJUnitTest.class); <span class="comment">// 测试用例 class</span></div><div class="line">        <span class="keyword">return</span> suite;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<div>参考资料：<a href="http://sns.testin.cn/thread-1529-1-1.html" target="_blank" rel="external">http://sns.testin.cn/thread-1529-1-1.html</a></div><br><div>AndroidStudio：<a href="http://www.jianshu.com/p/03118c11c199" target="_blank" rel="external">http://www.jianshu.com/p/03118c11c199</a></div><br><div></div><br><div>附件(doc)：</div><br><div><a href="http://ofc66dujp.bkt.clouddn.com/Android%E3%80%81JUnit%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA.doc" target="_blank" rel="external">Android、JUnit深入浅出</a></div>
</div></article><div class="tags"><a href="/tags/Android/">Android</a><a href="/tags/Instrument/">Instrument</a><a href="/tags/JUnit/">JUnit</a></div><div class="paginator"><a href="/2015/12/14/e9-80-9a-e8-bf-87-e7-8e-b0-e6-9c-89-e7-9a-84type-e6-88-96-e8-80-85-e6-b3-9b-e5-9e-8b-e8-8e-b7-e5-8f-96-e5-88-b0-e4-b8-80-e4-b8-aalist-e5-b0-81-e8-a3-85-e8-b5-b7-e6-9d-a5-e7-9a-84-e6-96-b0type-2/" class="prev"><i class="iconfont icon-left"></i><span> Prev</span></a><a href="/2015/12/02/e5-85-b3-e4-ba-8e-e6-88-91-e5-b8-b8-e7-94-a8-e6-a1-86-e6-9e-b6-e7-9a-84proguard-e6-b7-b7-e6-b7-86/" class="next"><span>Next</span><i class="iconfont icon-right"></i></a></div><section id="comments"><div data-thread-key="http://eraise.xyz/2015/12/03/junit-e6-b5-8b-e8-af-95android/index.html" data-title="Junit 测试Android" data-url="http://eraise.xyz/2015/12/03/junit-e6-b5-8b-e8-af-95android/index.html" class="ds-thread"></div><script type="text/javascript">var duoshuoQuery = {short_name: "eraise" };
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
})();</script></section></section><footer><div class="social"><a href="mailto:eraise@qq.com" title="email" class="iconfont icon-email"></a><a href="https://github.com/epolar" title="github" class="iconfont icon-github"></a><a href="/atom.xml" title="rss" class="iconfont icon-rss"></a></div><div class="copyright"><p class="power">Powered by <a href="https://hexo.io/">Hexo</a> and Theme by <a href="https://github.com/ahonn/hexo-theme-even"> Even</a></p><p class="since">&copy;2016<span class="heart"><i class="iconfont icon-heart"></i></span><span class="author">Eraise</span></p></div><div id="back2top"><i class="iconfont icon-up"></i></div></footer></div><script src="/js/zepto.min.js"></script><script src="/js/theme.js"></script></body></html>